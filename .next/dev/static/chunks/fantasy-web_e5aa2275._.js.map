{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/Downloads/fantasy-web/lib/supabase.ts"],"sourcesContent":["// lib/supabase.ts\nimport { createClient } from '@supabase/supabase-js'\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\n\n// ====================================\n// Á±ªÂûãÂÆö‰πâ\n// ====================================\n\nexport type League = {\n  id: string\n  name: string\n  commissioner_id: string\n  season: string\n  status: 'draft_pending' | 'drafting' | 'active' | 'completed'\n  max_teams: number\n  draft_type: 'snake' | 'linear'\n  draft_date?: string\n  scoring_type: string\n  created_at: string\n  updated_at: string\n}\n\nexport type Team = {\n  id: string\n  league_id: string\n  user_id: string\n  team_name: string\n  wins: number\n  losses: number\n  ties: number\n  total_points: number\n  draft_position: number\n  created_at: string\n}\n\nexport type DraftSettings = {\n  id: string\n  league_id: string\n  draft_type: 'snake' | 'linear'\n  seconds_per_pick: number\n  current_pick: number\n  current_round: number\n  total_rounds: number\n  is_paused: boolean\n  started_at?: string\n  completed_at?: string\n  created_at: string\n}\n\nexport type DraftPick = {\n  id: string\n  league_id: string\n  team_id: string\n  player_id: number\n  player_name: string\n  player_team: string\n  player_position: string\n  round: number\n  pick_number: number\n  overall_pick: number\n  picked_at: string\n}\n\nexport type TeamRoster = {\n  id: string\n  team_id: string\n  player_id: number\n  player_name: string\n  player_team: string\n  player_position: string\n  acquisition_type: 'draft' | 'waiver' | 'trade'\n  is_active: boolean\n  acquired_at: string\n}\n\nexport type Matchup = {\n  id: string\n  league_id: string\n  week: number\n  team1_id: string\n  team2_id: string\n  team1_points: number\n  team2_points: number\n  winner_id?: string\n  status: 'scheduled' | 'in_progress' | 'completed'\n  week_start_date: string\n  week_end_date: string\n  created_at: string\n}\n\n// ====================================\n// ËæÖÂä©ÂáΩÊï∞\n// ====================================\n\n/**\n * Ëé∑ÂèñÂΩìÂâçÁî®Êà∑\n */\nexport async function getCurrentUser() {\n  const { data: { user }, error } = await supabase.auth.getUser()\n  if (error) throw error\n  return user\n}\n\n/**\n * ËÆ°ÁÆóËõáÂΩ¢ÈÄâÁßÄÈ°∫Â∫è\n */\nexport function getSnakeDraftOrder(round: number, numTeams: number, position: number): number {\n  if (round % 2 === 1) {\n    // Â•áÊï∞ËΩÆÔºöÊ≠£Â∫è\n    return position\n  } else {\n    // ÂÅ∂Êï∞ËΩÆÔºöÂÄíÂ∫è\n    return numTeams - position + 1\n  }\n}\n\n/**\n * ËÆ°ÁÆóÂΩìÂâçÂ∫îËØ•ÈÄâÁßÄÁöÑÈòü‰ºç\n */\nexport async function getCurrentDraftingTeam(leagueId: string) {\n  // 1. Ëé∑ÂèñÈÄâÁßÄËÆæÁΩÆ\n  const { data: draftSettings, error: settingsError } = await supabase\n    .from('draft_settings')\n    .select('*')\n    .eq('league_id', leagueId)\n    .single()\n\n  if (settingsError || !draftSettings) return null\n\n  // 2. Ëé∑ÂèñÊâÄÊúâÈòü‰ºç\n  const { data: teams, error: teamsError } = await supabase\n    .from('teams')\n    .select('*')\n    .eq('league_id', leagueId)\n    .order('draft_position', { ascending: true })\n\n  if (teamsError || !teams) return null\n\n  // 3. ËÆ°ÁÆóÂΩìÂâçÂ∫îËØ•ÈÄâÁßÄÁöÑ‰ΩçÁΩÆ\n  const pickPosition = getSnakeDraftOrder(\n    draftSettings.current_round,\n    teams.length,\n    draftSettings.current_pick\n  )\n\n  // 4. ÊâæÂà∞ÂØπÂ∫îÁöÑÈòü‰ºç\n  return teams.find(t => t.draft_position === pickPosition)\n}\n\n/**\n * Ê£ÄÊü•ÊòØÂê¶ËΩÆÂà∞Êüê‰∏™Èòü‰ºçÈÄâÁßÄ\n */\nexport async function isMyTurn(leagueId: string, teamId: string): Promise<boolean> {\n  const currentTeam = await getCurrentDraftingTeam(leagueId)\n  return currentTeam?.id === teamId\n}\n\n/**\n * Ëé∑ÂèñËÅîËµõÁöÑÊâÄÊúâÂ∑≤ÈÄâÁêÉÂëòID\n */\nexport async function getDraftedPlayerIds(leagueId: string): Promise<number[]> {\n  const { data, error } = await supabase\n    .from('draft_picks')\n    .select('player_id')\n    .eq('league_id', leagueId)\n\n  if (error) throw error\n  return data?.map(p => p.player_id) || []\n}\n\n// ====================================\n// RealtimeËÆ¢ÈòÖËæÖÂä©ÂáΩÊï∞\n// ====================================\n\n/**\n * ËÆ¢ÈòÖÈÄâÁßÄÊàøÈó¥Êõ¥Êñ∞\n */\nexport function subscribeToDraftRoom(\n  leagueId: string,\n  onUpdate: (payload: any) => void\n) {\n  const channel = supabase\n    .channel(`draft_room_${leagueId}`)\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'draft_picks',\n        filter: `league_id=eq.${leagueId}`,\n      },\n      onUpdate\n    )\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'draft_settings',\n        filter: `league_id=eq.${leagueId}`,\n      },\n      onUpdate\n    )\n    .subscribe()\n\n  return channel\n}\n\n/**\n * ËÆ¢ÈòÖËÅîËµõÊõ¥Êñ∞\n */\nexport function subscribeToLeague(\n  leagueId: string,\n  onUpdate: (payload: any) => void\n) {\n  const channel = supabase\n    .channel(`league_${leagueId}`)\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'leagues',\n        filter: `id=eq.${leagueId}`,\n      },\n      onUpdate\n    )\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'teams',\n        filter: `league_id=eq.${leagueId}`,\n      },\n      onUpdate\n    )\n    .subscribe()\n\n  return channel\n}\n\n/**\n * ËÆ¢ÈòÖÁêÉÈòüÈòµÂÆπÊõ¥Êñ∞\n */\nexport function subscribeToTeamRoster(\n  teamId: string,\n  onUpdate: (payload: any) => void\n) {\n  const channel = supabase\n    .channel(`team_roster_${teamId}`)\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'team_rosters',\n        filter: `team_id=eq.${teamId}`,\n      },\n      onUpdate\n    )\n    .subscribe()\n\n  return channel\n}\n\n// ====================================\n// Êï∞ÊçÆÂ∫ìÊìç‰ΩúÂ∞ÅË£Ö\n// ====================================\n\n/**\n * ÂàõÂª∫ËÅîËµõ\n */\nexport async function createLeague(data: {\n  name: string\n  max_teams?: number\n  draft_type?: 'snake' | 'linear'\n}) {\n  const user = await getCurrentUser()\n  if (!user) throw new Error('Not authenticated')\n\n  const { data: league, error } = await supabase\n    .from('leagues')\n    .insert({\n      name: data.name,\n      commissioner_id: user.id,\n      max_teams: data.max_teams || 10,\n      draft_type: data.draft_type || 'snake',\n    })\n    .select()\n    .single()\n\n  if (error) throw error\n\n  // ÂàõÂª∫ÈÄâÁßÄËÆæÁΩÆ\n  await supabase\n    .from('draft_settings')\n    .insert({\n      league_id: league.id,\n      draft_type: data.draft_type || 'snake',\n    })\n\n  return league\n}\n\n/**\n * Âä†ÂÖ•ËÅîËµõ\n */\nexport async function joinLeague(leagueId: string, teamName: string) {\n  const user = await getCurrentUser()\n  if (!user) throw new Error('Not authenticated')\n\n  // 1. Ê£ÄÊü•ËÅîËµõÊòØÂê¶Â≠òÂú®ÂíåÊòØÂê¶Â∑≤Êª°\n  const { data: league, error: leagueError } = await supabase\n    .from('leagues')\n    .select('*, teams:teams(count)')\n    .eq('id', leagueId)\n    .single()\n\n  if (leagueError) throw leagueError\n  if (!league) throw new Error('League not found')\n\n  const currentTeams = league.teams[0]?.count || 0\n  if (currentTeams >= league.max_teams) {\n    throw new Error('League is full')\n  }\n\n  // 2. Ê£ÄÊü•ÊòØÂê¶Â∑≤Âä†ÂÖ•\n  const { data: existingTeam } = await supabase\n    .from('teams')\n    .select('id')\n    .eq('league_id', leagueId)\n    .eq('user_id', user.id)\n    .single()\n\n  if (existingTeam) {\n    throw new Error('Already joined this league')\n  }\n\n  // 3. ÂàõÂª∫Èòü‰ºç\n  const { data: team, error: teamError } = await supabase\n    .from('teams')\n    .insert({\n      league_id: leagueId,\n      user_id: user.id,\n      team_name: teamName,\n      draft_position: currentTeams + 1,\n    })\n    .select()\n    .single()\n\n  if (teamError) throw teamError\n  return team\n}\n\n/**\n * ÂºÄÂßãÈÄâÁßÄ\n */\nexport async function startDraft(leagueId: string) {\n  const user = await getCurrentUser()\n  if (!user) throw new Error('Not authenticated')\n\n  // 1. Ê£ÄÊü•ÊòØÂê¶ÊòØÁÆ°ÁêÜÂëò\n  const { data: league, error: leagueError } = await supabase\n    .from('leagues')\n    .select('commissioner_id')\n    .eq('id', leagueId)\n    .single()\n\n  if (leagueError) throw leagueError\n  if (league.commissioner_id !== user.id) {\n    throw new Error('Only commissioner can start the draft')\n  }\n\n  // 2. Êõ¥Êñ∞ËÅîËµõÁä∂ÊÄÅ\n  await supabase\n    .from('leagues')\n    .update({ status: 'drafting' })\n    .eq('id', leagueId)\n\n  // 3. Êõ¥Êñ∞ÈÄâÁßÄËÆæÁΩÆ\n  await supabase\n    .from('draft_settings')\n    .update({ started_at: new Date().toISOString() })\n    .eq('league_id', leagueId)\n}\n\n/**\n * ÈÄâÊã©ÁêÉÂëò\n */\nexport async function pickPlayer(\n  leagueId: string,\n  teamId: string,\n  player: {\n    id: number\n    name: string\n    team: string\n    position: string\n  }\n) {\n  const user = await getCurrentUser()\n  if (!user) throw new Error('Not authenticated')\n\n  // 1. Ê£ÄÊü•ÊòØÂê¶ËΩÆÂà∞ËØ•Èòü‰ºç\n  const currentTeam = await getCurrentDraftingTeam(leagueId)\n  if (!currentTeam || currentTeam.id !== teamId) {\n    throw new Error('Not your turn to pick')\n  }\n\n  // 2. Ê£ÄÊü•ÁêÉÂëòÊòØÂê¶Â∑≤Ë¢´ÈÄâ\n  const { data: existingPick } = await supabase\n    .from('draft_picks')\n    .select('id')\n    .eq('league_id', leagueId)\n    .eq('player_id', player.id)\n    .single()\n\n  if (existingPick) {\n    throw new Error('Player already drafted')\n  }\n\n  // 3. Ëé∑ÂèñÈÄâÁßÄËÆæÁΩÆ\n  const { data: draftSettings } = await supabase\n    .from('draft_settings')\n    .select('*')\n    .eq('league_id', leagueId)\n    .single()\n\n  if (!draftSettings) throw new Error('Draft settings not found')\n\n  // 4. Ëé∑ÂèñÈòü‰ºçÊï∞Èáè\n  const { count: teamCount } = await supabase\n    .from('teams')\n    .select('*', { count: 'exact', head: true })\n    .eq('league_id', leagueId)\n\n  const numTeams = teamCount || 0\n\n  // 5. ËÆ°ÁÆóoverall pick\n  const overallPick = \n    (draftSettings.current_round - 1) * numTeams +\n    getSnakeDraftOrder(draftSettings.current_round, numTeams, draftSettings.current_pick)\n\n  // 6. ËÆ∞ÂΩïÈÄâÁßÄÔºà‰ΩøÁî®‰∫ãÂä°Ôºâ\n  const { data: pick, error: pickError } = await supabase\n    .from('draft_picks')\n    .insert({\n      league_id: leagueId,\n      team_id: teamId,\n      player_id: player.id,\n      player_name: player.name,\n      player_team: player.team,\n      player_position: player.position,\n      round: draftSettings.current_round,\n      pick_number: draftSettings.current_pick,\n      overall_pick: overallPick,\n    })\n    .select()\n    .single()\n\n  if (pickError) throw pickError\n\n  // 7. Ê∑ªÂä†Âà∞ÈòµÂÆπ\n  await supabase\n    .from('team_rosters')\n    .insert({\n      team_id: teamId,\n      player_id: player.id,\n      player_name: player.name,\n      player_team: player.team,\n      player_position: player.position,\n      acquisition_type: 'draft',\n    })\n\n  // 8. Êõ¥Êñ∞ÈÄâÁßÄËøõÂ∫¶\n  let newPick = draftSettings.current_pick + 1\n  let newRound = draftSettings.current_round\n\n  if (newPick > numTeams) {\n    newPick = 1\n    newRound = newRound + 1\n  }\n\n  const updateData: any = {\n    current_pick: newPick,\n    current_round: newRound,\n  }\n\n  // Ê£ÄÊü•ÊòØÂê¶ÂÆåÊàê\n  if (newRound > draftSettings.total_rounds) {\n    updateData.completed_at = new Date().toISOString()\n    \n    // Êõ¥Êñ∞ËÅîËµõÁä∂ÊÄÅ‰∏∫active\n    await supabase\n      .from('leagues')\n      .update({ status: 'active' })\n      .eq('id', leagueId)\n  }\n\n  await supabase\n    .from('draft_settings')\n    .update(updateData)\n    .eq('league_id', leagueId)\n\n  return pick\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/Downloads/fantasy-web/app/league/new/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { supabase } from \"@/lib/supabase\";\n\nexport default function NewLeaguePage() {\n  const router = useRouter();\n  const [name, setName] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n\n    if (!name.trim()) {\n      setError(\"ËØ∑ËæìÂÖ•ËÅîËµõÂêçÁß∞\");\n      return;\n    }\n\n    if (name.trim().length < 2) {\n      setError(\"ËÅîËµõÂêçÁß∞Ëá≥Â∞ë 2 ‰∏™Â≠óÁ¨¶\");\n      return;\n    }\n\n    setSubmitting(true);\n    setError(null);\n\n    try {\n      // Áõ¥Êé•ÊèíÂÖ•Êï∞ÊçÆÔºå‰ΩøÁî®ÊµãËØïÁî®Êà∑ID\n      const testUserId = \"test-user-\" + Date.now();\n      \n      const { data: league, error: createError } = await supabase\n        .from('leagues')\n        .insert({\n          name: name.trim(),\n          commissioner_id: testUserId,\n          max_teams: 10,\n          draft_type: 'snake',\n        })\n        .select()\n        .single();\n\n      if (createError) throw createError;\n\n      // ÂàõÂª∫ÈÄâÁßÄËÆæÁΩÆ\n      await supabase\n        .from('draft_settings')\n        .insert({\n          league_id: league.id,\n          draft_type: 'snake',\n        });\n\n      alert('ËÅîËµõÂàõÂª∫ÊàêÂäüÔºÅID: ' + league.id);\n      \n      // Ë∑≥ËΩ¨Âà∞ËÅîËµõÈ°µÈù¢\n      router.push(`/league/${league.id}`);\n    } catch (err: any) {\n      console.error('Create league error:', err);\n      setError(err.message || \"ÂàõÂª∫Â§±Ë¥•\");\n      setSubmitting(false);\n    }\n  }\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: '#0a0a0a',\n      padding: '24px 16px'\n    }}>\n      <div style={{\n        maxWidth: '500px',\n        margin: '0 auto'\n      }}>\n        <div style={{\n          background: '#111',\n          border: '1px solid #222',\n          borderRadius: '16px',\n          padding: '32px'\n        }}>\n          <div style={{\n            textAlign: 'center',\n            marginBottom: '32px'\n          }}>\n            <div style={{ fontSize: '48px', marginBottom: '16px' }}>üèÜ</div>\n            <h1 style={{\n              fontSize: '24px',\n              fontWeight: '700',\n              color: '#f59e0b',\n              margin: '0 0 8px 0'\n            }}>\n              ÂàõÂª∫ËÅîËµõ\n            </h1>\n            <p style={{\n              fontSize: '14px',\n              color: '#666',\n              margin: 0\n            }}>\n              ÂàõÂª∫‰Ω†ÁöÑ Fantasy ÁØÆÁêÉËÅîËµõ\n            </p>\n          </div>\n\n          <form onSubmit={handleSubmit}>\n            {/* ËÅîËµõÂêçÁß∞ */}\n            <div style={{ marginBottom: '24px' }}>\n              <label style={{\n                display: 'block',\n                fontSize: '14px',\n                fontWeight: '500',\n                color: '#fff',\n                marginBottom: '8px'\n              }}>\n                ËÅîËµõÂêçÁß∞\n              </label>\n              <input\n                type=\"text\"\n                value={name}\n                onChange={(e) => setName(e.target.value)}\n                placeholder=\"‰æãÂ¶ÇÔºö2024 Fantasy ËÅîËµõ\"\n                maxLength={50}\n                disabled={submitting}\n                style={{\n                  width: '100%',\n                  padding: '14px 16px',\n                  background: '#1a1a1a',\n                  border: '1px solid #333',\n                  borderRadius: '10px',\n                  color: '#fff',\n                  fontSize: '15px',\n                  outline: 'none',\n                  boxSizing: 'border-box'\n                }}\n              />\n              <div style={{\n                fontSize: '12px',\n                color: '#666',\n                textAlign: 'right',\n                marginTop: '4px'\n              }}>\n                {name.length}/50\n              </div>\n            </div>\n\n            {/* ÈîôËØØÊèêÁ§∫ */}\n            {error && (\n              <div style={{\n                padding: '12px 16px',\n                background: 'rgba(239, 68, 68, 0.15)',\n                border: '1px solid rgba(239, 68, 68, 0.3)',\n                borderRadius: '8px',\n                color: '#fca5a5',\n                fontSize: '14px',\n                marginBottom: '24px'\n              }}>\n                {error}\n              </div>\n            )}\n\n            {/* ÊåâÈíÆ */}\n            <div style={{\n              display: 'flex',\n              gap: '12px',\n              marginTop: '8px'\n            }}>\n              <button\n                type=\"button\"\n                onClick={() => router.back()}\n                disabled={submitting}\n                style={{\n                  flex: 1,\n                  padding: '14px',\n                  background: 'transparent',\n                  border: '1px solid #333',\n                  borderRadius: '10px',\n                  color: '#888',\n                  fontSize: '15px',\n                  cursor: 'pointer'\n                }}\n              >\n                ÂèñÊ∂à\n              </button>\n              <button\n                type=\"submit\"\n                disabled={submitting || !name.trim()}\n                style={{\n                  flex: 2,\n                  padding: '14px',\n                  background: submitting || !name.trim() ? '#666' : '#f59e0b',\n                  border: 'none',\n                  borderRadius: '10px',\n                  color: '#000',\n                  fontSize: '15px',\n                  fontWeight: '600',\n                  cursor: submitting || !name.trim() ? 'not-allowed' : 'pointer'\n                }}\n              >\n                {submitting ? 'ÂàõÂª∫‰∏≠...' : 'ÂàõÂª∫ËÅîËµõ'}\n              </button>\n            </div>\n          </form>\n\n          {/* ÊµãËØïÊèêÁ§∫ */}\n          <div style={{\n            marginTop: '24px',\n            padding: '12px',\n            background: 'rgba(59, 130, 246, 0.1)',\n            border: '1px solid rgba(59, 130, 246, 0.3)',\n            borderRadius: '8px',\n            fontSize: '13px',\n            color: '#60a5fa'\n          }}>\n            ‚ö†Ô∏è ÊµãËØïÊ®°ÂºèÔºö‰ΩøÁî®‰∏¥Êó∂Áî®Êà∑IDÂàõÂª∫ËÅîËµõ\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}